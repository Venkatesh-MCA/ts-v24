<main id="main" class="main">
  <div class="row dashboard mb-3" *ngIf="stuResult!=null">
    <div class="col-lg col-md-6" *ngFor="let x of setstatusobj">
      <div class="card mb-2 info-card bs-card-border customer-card text-muted">
        <div class="card-body">
          <h5 class="card-title"> {{x.name}} <span></span></h5>
          <div class="d-flex align-items-center justify-content-between">
            <div style="background:#ececec"
              class="card-icon-orange card-icon rounded-circle d-flex align-items-center justify-content-center"
              *ngIf="x.name=='Started'">
              <img src="assets/img/start.svg" style="width:32px" alt="" />
            </div>
            <div class="card-icon-yellow card-icon rounded-circle d-flex align-items-center justify-content-center"
              *ngIf="x.name=='Continue'">
              <img style="width: 32px" src="assets/img/continue2.svg" alt="1" />
            </div>
            <div class="card-icon-green card-icon rounded-circle d-flex align-items-center justify-content-center"
              *ngIf="x.name=='Completed'">
              <img src="assets/img/completed.svg" style="width: 32px" alt="1" />
            </div>
            <div class="card-icon-blue card-icon rounded-circle d-flex align-items-center justify-content-center"
              *ngIf="x.name=='Total'"><i class="bi bi-layers"></i></div>
            <div class="ps-3">
              <h6><span style="margin: 0;font-weight:bold;">{{x.noofstds}}</span></h6>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="stuResult.length==0" class="noData"> No Result Found </div>
  </div>
  <div class="card card-body" style="margin-top:-10px;font-size: 10px" *ngIf="stuResult!=null &&  stuResult.length!=0">
    <div id="example4" role="execelBlock">
      <div class="d-flex align-items-center gap-3 justify-content-between py-3">
        <div class="hstack justify-content-start">
          <img src="assets/img/live1.png" style="width: 40px;">&nbsp;
          <h5 class="card-title d-flex flex-column">
            Live Result<div class="text-muted small" style="font-weight:400;margin-top:2px;">{{selectpapercode}}</div>
          </h5>
          <!-- <span style="font-size:14px;">Paper Code:&nbsp;</span> -->
        </div>
        <div class="hstack gap-3">
          <input type="text" class="form-control form-select" placeholder="Search..." minlength="2"
            aria-describedby="basic-addon2" name="searchText" [(ngModel)]="searchText"
            required style=""
            style="height:38px;padding: 8px;width: 270px;border: 1px #ced4e2 solid;border-radius: 4px;z-index: 50">
          <select id="inputbranch" class="form-select" [(ngModel)]="filtertext" (change)="searchdatafilter(filtertext)"
            style="width:150px;">
            <option value="" [selected]="filtertext==''">ALL</option>
            <!-- <option *ngFor="let b of unicbranch">{{b}}</option> -->
            <option *ngFor="let b of unicbranch" [ngValue]="b" [selected]="b===filtertext">
              {{b}}</option>
          </select>
          <div class="btn btn-primary py-0 px-1 rounded-1"><i class="ri-file-excel-2-line fs-5"
              (click)="exportexcel(selectpapercode)"></i>
          </div>
          
          <div class="btn btn-success py-0 px-1 rounded-1" title="Final Result" *ngIf="sesinst=='junior'"><a href="#/reports/finalresult/{{selectpapercode}}" class="text-white"> <i class="bi bi-mortarboard fs-5"></i></a>
        </div>
        </div>
      </div>
      <div class="table-responsive;" style="overflow-x: auto">
        <table width="100%" cellspacing="0" cellpadding="2" border="1"
          style="border-color: #ccc;border-collapse: collapse;text-align: center;" id="excel-table">
          <thead style="color: #012970;background-color: #326ef61a;font-weight: 100;">
            <tr>
              <th valign="bottom" style="text-align: center;font-weight: 600;"> S.NO </th>
              <th valign="bottom" style="font-weight: 600;"> SUC </th>
              <th valign="bottom" style="text-align: left;white-space: nowrap;font-weight: 600;">STUDENT NAME </th>
              <th valign="bottom" style="text-align: left;white-space: nowrap;font-weight: 600;">BRANCH </th>
              <th style="width: 50px;background-color:#ececec;text-align: center;" *ngFor="let s of sheaderobj">
                <table width="100%" border="0" cellspacing="3" cellpadding="3" role="sub1" style="font-weight: 600">
                  <tbody>
                    <tr>
                      <td colspan="8" style="background-color: #256EF9;color: #fff;height: 24px;"> {{s.sujbectname}}
                        &nbsp; ({{s.MAxmarks}}) </td>
                    </tr>
                    <tr>
                      <td colspan="6" style="border-bottom: 1px #ccc solid;height: 24px;"> Q. ANALYSIS </td>
                      <td rowspan="2" style="line-height: 1;
											position: relative;
											-webkit-transform: rotate(180deg);
											transform: rotate(180deg);
											white-space: nowrap;
											-webkit-writing-mode: vertical-rl;
											writing-mode: vertical-rl;
											border-radius: 0 5px 5px 0;
											padding: 0 0.8rem;
											text-align: center;
											text-shadow: 0px 2px 2px rgb(0 0 0 / 5%);
											letter-spacing: 0.9px;width: 69px;">TIME</td>
                      <td rowspan="2" style="line-height: 1;
											position: relative;
											-webkit-transform: rotate(180deg);
											transform: rotate(180deg);
											white-space: nowrap;
											-webkit-writing-mode: vertical-rl;
											writing-mode: vertical-rl;
											border-radius: 0 5px 5px 0;
											padding: 0 0.8rem;
											text-align: center;
											text-shadow: 0px 2px 2px rgb(0 0 0 / 5%);
											letter-spacing: 0.9px;width: 69px;">RANK</td>
                    </tr>
                    <tr>
                      <td
                        style="box-sizing: border-box; min-width: 40px;padding:3px 0;margin: 0;box-sizing: content-box;background-color: #D1E7DD;color: #125133 !important;text-align: center;border: 1px #ccc solid;">
                        R </td>
                      <td
                        style="box-sizing: border-box; min-width: 40px;padding: 0;margin: 0;box-sizing: content-box;background-color: #F7D7DA;color: #831F2B !important;text-align: center;border: 1px #ccc solid;">
                        W </td>
                      <td
                        style="box-sizing: border-box; min-width: 40px;padding: 0;margin: 0;box-sizing: content-box;background-color: #FEF3CF;color: #654D0D !important;text-align: center;border: 1px #ccc solid;">
                        L </td>
                      <td
                        style="box-sizing: border-box; min-width: 40px;padding: 0;margin: 0;box-sizing: content-box;background: #d0e2fe;color: #052c65;text-align: center;border: 1px #ccc solid;">
                        MARKS </td>
                    </tr>
                  </tbody>
                </table>
              </th>
              <th style="text-align: center;line-height: 1;
								position: relative;
								-webkit-transform: rotate(180deg);
								transform: rotate(180deg);
								white-space: nowrap;
								-webkit-writing-mode: vertical-rl;
								writing-mode: vertical-rl;
								border-radius: 0 5px 5px 0;
								padding: 0 0.8rem;
								text-align: center;
								text-shadow: 0px 2px 2px rgb(0 0 0 / 5%);
								letter-spacing: 0.9px;
								width: 29px;font-weight: 600"> Total Marks ({{getSumElements(sheaderobj,'MAxmarks')}})</th>
              <th style="text-align: center;font-weight: 600"> Time <br />
                ( {{convertMinutesToHoursMinutesSeconds(stuResult[0].duration)}})
                <div style="font-size: 10px;opacity: 0.5;">(HH:MM:SS)</div>
              </th>
              <th style="text-align: center;font-weight: 600"> Rank </th>
            </tr>
          </thead>
          <tbody *ngFor="let x of stuResult  | filter:filtertext  | filter :searchText ;let i=index" class="ng-scope">
            <tr style="border-bottom: 1px #ccc solid">
              <td style="text-align: center;">{{i+1}} </td>
              <td style="text-align: center;background: #ececec;
								color: #654D0D !important;padding: 9px;" *ngIf="x.exam_status=='Started'">{{x.suc}} </td>
              <td style="text-align: center;background: #FEF3CF;
								color: #654D0D !important;padding: 9px;" *ngIf="x.exam_status=='Continue'">{{x.suc}} </td>
              <td style="text-align: center;background:  #D1E7DD;
								color: #654D0D !important;padding: 9px;width:150px;" *ngIf="x.exam_status=='Completed'">{{x.suc}} <a
                  style="text-decoration: none;cursor: pointer;color: #fff;display: inline-flex;justify-content: space-between;align-items: center;background: #1f8755;
								   padding-right: 5px; padding-left: 5px;line-height: 19px;border-radius: 3px;column-gap: 3px;margin-left: 10px" (click)="download_qanalysis(x.suc,x.paperCode)" title="{{x.suc}}"> <i
                    class="bi bi-file-earmark-pdf-fill" style="color: #fff;"></i> <span>QR</span> </a></td>
              <td style="text-align:left;white-space:nowrap;max-width:300px;"
                ng-click="show_qwisereport(currentpapercode,strikedata,studenrresult[$index],MAXSCORE,MINSCORE,nofostudents,quepaper,subjects,studenrresult.length,studenrresult)">
                {{x.student}} </td>
              <td style="text-align: center;white-space:nowrap">{{x.stu_branch}} </td>
              <td style="text-align: center;" *ngFor="let y of x.finalsummary">
                <table width="100%" border="0" cellspacing="3" cellpadding="3" role="cnt1">
                  <tbody>
                    <tr style="line-height: 24px;">
                      <td
                        style="box-sizing: border-box; min-width: 40px;padding: 0;margin: 0;box-sizing: content-box;background-color: #D1E7DD;color: #125133 !important;text-align: center;border: 1px #ccc solid;">
                        {{y.R}} </td>
                      <td
                        style="box-sizing: border-box; min-width: 40px;padding: 0;margin: 0;box-sizing: content-box;background-color: #F7D7DA;color: #831F2B !important;text-align: center;border: 1px #ccc solid;">
                        {{y.W}} </td>
                      <td
                        style="box-sizing: border-box; min-width: 40px;padding: 0;margin: 0;box-sizing: content-box;background-color: #FEF3CF;color: #654D0D !important;text-align: center;border: 1px #ccc solid;">
                        {{y.L}} </td>
                      <td
                        style="box-sizing: border-box; min-width: 40px;padding: 0;margin: 0;box-sizing: content-box;background: #d0e2fe;color: #052c65;text-align: center;border: 1px #ccc solid;">
                        {{y.M}} </td>
                      <td
                        style="box-sizing: border-box; min-width: 40px;padding: 0;margin: 0;box-sizing: content-box;background: #ececec;border-right: 1px #ccc solid;text-align: center;border: 1px #ccc solid;">
                        {{ secondsToMinutesAndSeconds(1*y.T) }} </td>
                      <td
                        style="box-sizing: border-box; min-width: 40px;padding: 0;margin: 0;box-sizing: content-box;background: #ececec;border-right: 1px #ccc solid;text-align: center;border: 1px #ccc solid;">
                        {{ y.rank}} </td>
                    </tr>
                  </tbody>
                </table>
              </td>
              <td
                style="width: 37px;padding: 0;margin: 0;box-sizing: content-box;color: #052c65;text-align: center;position: relative">
                <div style="background: #d1e2fd;height: 26px;width:40px;line-height: 25px;border: 1px #ccc solid;">
                  {{x.TOTALMATKS}} </div>
              </td>
              <td style="text-align: center;"> {{secondsToMinutesAndSeconds(1*x.TTLTIME)}} </td>
              <td style="text-align: center;" *ngIf="x.finalsummary"> {{x.finalsummary[0].total_rank}} </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

</main>